define(["core/Logger","core/API"],function(Logger,API){var DateUtils={initAPI:function(API){API.mixin("Date",this)},parseMilitaryTime:function(militaryTime){var timeArray=militaryTime.split(":"),hour=parseInt(timeArray[0],10),min=parseInt(timeArray[1],10),ampm=hour>=12?"pm":"am";hour=hour>=12?hour-12:hour;var displayHour=0===hour?12:hour,ampmString=API.Chrome.Translation.get("pm"===ampm?"timePM":"timeAM");return{hour:this.toTwoDigits(displayHour),min:this.toTwoDigits(min),ampm:ampm,display:displayHour+":"+this.toTwoDigits(min)+" "+ampmString}},timestampToDisplayDate:function(timestamp){var date=new Date(timestamp),dateObj={};return dateObj.month=date.getMonth()+1,dateObj.day=date.getDate(),dateObj.year=date.getFullYear(),dateObj.hours=date.getHours(),dateObj.minutes=date.getMinutes(),dateObj.month=this.toTwoDigits(dateObj.month),dateObj.day=this.toTwoDigits(dateObj.day),dateObj.minutes=this.toTwoDigits(dateObj.minutes),dateObj.ampm=API.Chrome.Translation.get(dateObj.hours>=12?"timePM":"timeAM"),dateObj.hours=dateObj.hours>12?dateObj.hours-12:dateObj.hours,0==dateObj.hours&&(dateObj.hours=12,dateObj.ampm=API.Chrome.Translation.get("timeAM")),dateObj},hasTimePassed:function(hour,min,ampm,nowDate){hour="pm"==ampm?parseInt(hour,10)+12:hour,nowDate=nowDate||new Date;var dateString=nowDate.toDateString(),testDate=new Date(dateString+" "+hour+":"+min);return nowDate>testDate},secondsUntilTime:function(hour,min,ampm,nowDate){hour="pm"==ampm?parseInt(hour,10)+12:hour,nowDate=nowDate||new Date;var dateString=nowDate.toDateString(),testDate=new Date(dateString+" "+hour+":"+min),msRemaining=testDate.getTime()-nowDate.getTime();return Math.floor(msRemaining/1e3)},minutesUntilTime:function(hour,min,ampm,nowDate){var seconds=this.secondsUntilTime(hour,min,ampm,nowDate);return Math.floor(seconds/60)},getTodayDateObj:function(hour,min,ampm,nowDate){hour="pm"==ampm?parseInt(hour,10)+12:hour,nowDate=nowDate||new Date;var dateString=nowDate.toDateString();return new Date(dateString+" "+hour+":"+min)},hoursToMilliseconds:function(hours){return 60*parseFloat(hours)*60*1e3},timeUnitToMilliseconds:function(num,unit){if(!this.isValidTimeUnit(unit))throw new Error('[DateUtils.timeUnitToMilliseconds()] Could not convert time unit to milliseconds. "'+unit+'" is not a valid time unit.');return num=parseFloat(num),this.isValidHourUnit(unit)?60*num*60*1e3:this.isValidMinUnit(unit)?60*num*1e3:this.isValidSecUnit(unit)?1e3*num:num},isValidTime:function(time,format){if("string"!=typeof time||2!==time.indexOf(":")||5!==time.length)return!1;format=12===format?12:24;var timeArray=time.split(":"),hour=parseInt(timeArray[0]),min=parseInt(timeArray[1]);return min>=0&&59>=min&&(12===format&&hour>=1&&12>=hour||24===format&&hour>=0&&23>=hour)},isValidTimeUnit:function(unit){return this.isValidHourUnit(unit)||this.isValidMinUnit(unit)||this.isValidSecUnit(unit)||this.isValidMSUnit(unit)},isValidHourUnit:function(unit){return"string"==typeof unit&&(0===unit.indexOf("hour")||0===unit.indexOf("hr")||"h"===unit)},isValidMinUnit:function(unit){return"string"==typeof unit&&(0===unit.indexOf("min")||"m"===unit)},isValidSecUnit:function(unit){return"string"==typeof unit&&(0===unit.indexOf("sec")||"s"===unit)},isValidMSUnit:function(unit){return"string"==typeof unit&&(0===unit.indexOf("millis")||"ms"===unit)},dayNumToDay:function(dayNum,abbreviated){if(0>dayNum||dayNum>6)throw new Error("[DateUtils.dayNumToDay()] Day num must be between 0 and 6");var days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return abbreviated===!0?shortDays[dayNum]:days[dayNum]},getDaysInMonth:function(month,year){var todayDate=new Date;return month=month||todayDate.getMonth(),year=year||todayDate.getYear(),32-new Date(year,month,32).getDate()},secondsToMinsAndSecs:function(totalSeconds){return totalSeconds/60===Math.floor(totalSeconds/60)?totalSeconds/60+" minutes":Math.floor(totalSeconds/60)+" minutes and "+(totalSeconds-60*Math.floor(totalSeconds/60))+" seconds"},toTwoDigits:function(num){return 10>num?"0"+num:num},getYMD:function(date){date=date||new Date;var month=this.toTwoDigits(date.getMonth()+1),day=this.toTwoDigits(date.getDate()),year=date.getFullYear();return year+"-"+month+"-"+day}};return DateUtils});