define(["core/Logger","core/CoreAPI","core/vendor/jquery.min","core/vendor/Brightline.min","core/vendor/text!components/List/list.tpl","core/vendor/text!components/Blacklist/blacklist.tpl","components/List/ListView"],function(Logger,API,$,Brightline,listTpl,blockedSitesTpl,ListView){return API.Class.extend(ListView,{setJQuery:function(jQuery){$=jQuery||$,this._parent.setJQuery(jQuery)},refreshList:function(){this._parent.refreshList($("#blockedSitesList"),$("#newBlockedSites"))},render:function(){return this._parent.render(blockedSitesTpl)},renderList:function(){return this._parent.renderList("hideOnBypass")},bindUIHandlers:function(){this._parent.bindUIHandlers(),this.bindBlacklistUIHandlers()},bindListUIHandlers:function(){this._parent.bindListUIHandlers()},bindBlacklistUIHandlers:function(){var $blockedSitesMsg=$("#blockedSitesMsg"),$stalkerOptionInput=$("input[name=stalkerOption]"),self=this;API.StayFocusd.isMaxTimeAllowedExceeded()&&($blockedSitesMsg.html(API.Chrome.Translation.get("cannotRemoveBlockedSites")),$blockedSitesMsg.show()),$("input[name=addBlockedSites]").click(function(){API.PubSub.publish(self.getClassName()+".domains.add.BLACKLIST")}),$stalkerOptionInput.click(function(){API.PubSub.publish(self.getClassName()+".checkbox.toggle.STALKER_OPTION")}),$("#showSuggestedSitesList").click(function(){API.PubSub.publish(self.getClassName()+".data.load.SUGGESTED_SITES")}),$("#blockExtensionsPage").click(function(){API.PubSub.publish(self.getClassName()+".domain.add.BLACKLIST",{domain:"chrome://extensions"})}),API.StayFocusd.isOutgoingLinksOptionActive()&&($stalkerOptionInput.prop("checked",!0),API.StayFocusd.isMaxTimeAllowedExceeded()&&$stalkerOptionInput.prop("disabled",!0))},addListeners:function(){var self=this;API.PubSub.listen("*.data.loaded.SUGGESTED_SITES",function(message,payload){self.renderSuggestedSitesList(payload.data)}),this._parent.addListeners()},getNewDomains:function(){return this._parent.getNewDomains($("#newBlockedSites").val())},renderSuggestedSitesList:function(siteList){var self=this,template=new Brightline(listTpl);for(var name in siteList)if(siteList.hasOwnProperty(name)){var domain=siteList[name];if(self.model.has(domain))continue;var id=name.split(" ").join("-").toLowerCase();template.set("id",id),template.set("addToList",API.Chrome.Translation.get("addToList")),template.set("domain",name),template.parse("addDomain")}$("#suggestedSitesList").html(template.render()),this.bindSuggestedSitesListUIHandlers(siteList)},bindSuggestedSitesListUIHandlers:function(siteList){var self=this;for(var name in siteList)if(siteList.hasOwnProperty(name)){var domain=siteList[name];if(self.model.has(domain))continue;var id=name.split(" ").join("-").toLowerCase();!function(d,i){$("#"+i+" img").click(function(){API.PubSub.publish(self.getClassName()+".domain.add.BLACKLIST",{domain:d}),$("#"+i).remove()})}(domain,id)}$("#suggestedSites").slideToggle()}})});